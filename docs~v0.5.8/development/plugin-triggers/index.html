<!--
  Copyright (c) 2016-2022 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dokku.com/docs/development/plugin-triggers/">
      
      <link rel="icon" href="../../assets/favicons/favicon-96x96.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.2">
    
    
      
        <title>Plugin triggers - Dokku Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    

  <!-- Extra style sheets (can't be set in mkdocs.yml due to content hash) -->
  <link
    rel="stylesheet"
    href="../../overrides/assets/stylesheets/main.css"
  />

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#plugin-triggers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  <a href="https://twitter.com/dokku">
    For updates follow <strong>@dokku</strong> on
    <span class="twemoji twitter">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </span>
    <strong>Twitter</strong>
  </a>

          </div>
          
        </aside>
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Dokku Documentation" class="md-header__button md-logo" aria-label="Dokku Documentation" data-md-component="logo">
      
  <img src="../../assets/dokku-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dokku Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Plugin triggers
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/dokku/dokku" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link md-tabs__link--active">
        Docs
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://pro.dokku.com/docs/getting-started/" class="md-tabs__link">
      Pro
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://pro.dokku.com/blog/" class="md-tabs__link">
      Blog
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://dokku.dpdcart.com/cart/add?product_id=217344&method_id=236878" class="md-tabs__link">
      Purchase Dokku Pro
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Dokku Documentation" class="md-nav__button md-logo" aria-label="Dokku Documentation" data-md-component="logo">
      
  <img src="../../assets/dokku-logo.svg" alt="logo">

    </a>
    Dokku Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dokku/dokku" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1" type="checkbox" id="__nav_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_1">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Getting Started with Dokku
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrading/" class="md-nav__link">
        Upgrading
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/where-to-get-help/" class="md-nav__link">
        Where to Get Help
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_2">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deployment" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          Deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../application-deployment/" class="md-nav__link">
        Deploying to Dokku
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/buildpacks/" class="md-nav__link">
        Buildpack Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/dockerfiles/" class="md-nav__link">
        Dockerfile Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/images/" class="md-nav__link">
        Image Tagging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../remote-commands/" class="md-nav__link">
        Remote Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/one-off-processes/" class="md-nav__link">
        One-off Processes and Cron
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process-management/" class="md-nav__link">
        Process/Container management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/user-management/" class="md-nav__link">
        User Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../checks-examples/" class="md-nav__link">
        Zero Downtime Deploys
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_3">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration-management/" class="md-nav__link">
        Environment Variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dns/" class="md-nav__link">
        DNS Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/domain-configuration/" class="md-nav__link">
        Domain Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx/" class="md-nav__link">
        Nginx Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/ssl-configuration/" class="md-nav__link">
        SSL Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dokku-events-logs/" class="md-nav__link">
        Dokku Event Logs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4">
          Advanced Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced Usage" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Advanced Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backup-recovery/" class="md-nav__link">
        Backup and Recovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/deployment-tasks/" class="md-nav__link">
        Deployment Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-options/" class="md-nav__link">
        Docker Container Options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dokku-storage/" class="md-nav__link">
        Dokku Core Storage Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../proxy/" class="md-nav__link">
        Proxy plugin
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          Community Contributions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Community Contributions" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Community Contributions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../community/clients/" class="md-nav__link">
        Clients
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Development" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugin-creation/" class="md-nav__link">
        Plugin Creation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Plugin triggers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Plugin triggers
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#available-plugin-triggers" class="md-nav__link">
    Available plugin triggers
  </a>
  
    <nav class="md-nav" aria-label="Available plugin triggers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-config-update" class="md-nav__link">
    post-config-update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind-external-ip" class="md-nav__link">
    bind-external-ip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-deploy" class="md-nav__link">
    check-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comands-help-and-commands-plugin_namehelp" class="md-nav__link">
    comands help and commands &lt;PLUGIN_NAME&gt;:help
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-args-build" class="md-nav__link">
    docker-args-build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-args-deploy" class="md-nav__link">
    docker-args-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-args-run" class="md-nav__link">
    docker-args-run
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-post-pull" class="md-nav__link">
    git-post-pull
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-pre-pull" class="md-nav__link">
    git-pre-pull
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-hostname" class="md-nav__link">
    nginx-hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-pre-reload" class="md-nav__link">
    nginx-pre-reload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-build-buildpack" class="md-nav__link">
    post-build-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-build-dockerfile" class="md-nav__link">
    post-build-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-create" class="md-nav__link">
    post-create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-delete" class="md-nav__link">
    post-delete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-deploy" class="md-nav__link">
    post-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-domains-update" class="md-nav__link">
    post-domains-update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-release-buildpack" class="md-nav__link">
    post-release-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-release-dockerfile" class="md-nav__link">
    post-release-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-stop" class="md-nav__link">
    post-stop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-build-buildpack" class="md-nav__link">
    pre-build-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-build-dockerfile" class="md-nav__link">
    pre-build-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-delete" class="md-nav__link">
    pre-delete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-deploy" class="md-nav__link">
    pre-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-receive-app" class="md-nav__link">
    pre-receive-app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-release-buildpack" class="md-nav__link">
    pre-release-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-release-dockerfile" class="md-nav__link">
    pre-release-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-app" class="md-nav__link">
    receive-app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-branch" class="md-nav__link">
    receive-branch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retire-container-failed" class="md-nav__link">
    retire-container-failed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags-create" class="md-nav__link">
    tags-create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags-destroy" class="md-nav__link">
    tags-destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-auth" class="md-nav__link">
    user-auth
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        Dokku test suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-process/" class="md-nav__link">
        Release Process
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://pro.dokku.com/docs/getting-started/" class="md-nav__link">
        Pro
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://pro.dokku.com/blog/" class="md-nav__link">
        Blog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://dokku.dpdcart.com/cart/add?product_id=217344&method_id=236878" class="md-nav__link">
        Purchase Dokku Pro
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#available-plugin-triggers" class="md-nav__link">
    Available plugin triggers
  </a>
  
    <nav class="md-nav" aria-label="Available plugin triggers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-config-update" class="md-nav__link">
    post-config-update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind-external-ip" class="md-nav__link">
    bind-external-ip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-deploy" class="md-nav__link">
    check-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comands-help-and-commands-plugin_namehelp" class="md-nav__link">
    comands help and commands &lt;PLUGIN_NAME&gt;:help
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-args-build" class="md-nav__link">
    docker-args-build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-args-deploy" class="md-nav__link">
    docker-args-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-args-run" class="md-nav__link">
    docker-args-run
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-post-pull" class="md-nav__link">
    git-post-pull
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-pre-pull" class="md-nav__link">
    git-pre-pull
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-hostname" class="md-nav__link">
    nginx-hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-pre-reload" class="md-nav__link">
    nginx-pre-reload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-build-buildpack" class="md-nav__link">
    post-build-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-build-dockerfile" class="md-nav__link">
    post-build-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-create" class="md-nav__link">
    post-create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-delete" class="md-nav__link">
    post-delete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-deploy" class="md-nav__link">
    post-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-domains-update" class="md-nav__link">
    post-domains-update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-release-buildpack" class="md-nav__link">
    post-release-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-release-dockerfile" class="md-nav__link">
    post-release-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-stop" class="md-nav__link">
    post-stop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-build-buildpack" class="md-nav__link">
    pre-build-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-build-dockerfile" class="md-nav__link">
    pre-build-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-delete" class="md-nav__link">
    pre-delete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-deploy" class="md-nav__link">
    pre-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-receive-app" class="md-nav__link">
    pre-receive-app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-release-buildpack" class="md-nav__link">
    pre-release-buildpack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-release-dockerfile" class="md-nav__link">
    pre-release-dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-app" class="md-nav__link">
    receive-app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-branch" class="md-nav__link">
    receive-branch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retire-container-failed" class="md-nav__link">
    retire-container-failed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags-create" class="md-nav__link">
    tags-create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags-destroy" class="md-nav__link">
    tags-destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-auth" class="md-nav__link">
    user-auth
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/dokku/dokku/edit/master/docs/development/plugin-triggers.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="plugin-triggers">Plugin triggers</h1>
<p><a href="https://github.com/dokku/plugn">Plugin triggers</a> (formerly <a href="https://github.com/progrium/pluginhook">pluginhooks</a>) are a good way to jack into existing dokku infrastructure. You can use them to modify the output of various dokku commands or override internal configuration.</p>
<p>Plugin triggers are simply scripts that are executed by the system. You can use any language you want, so long as the script:</p>
<ul>
<li>Is executable</li>
<li>Has the proper language requirements installed</li>
</ul>
<p>For instance, if you wanted to write a plugin trigger in PHP, you would need to have <code>php</code> installed and available on the CLI prior to plugin trigger invocation.</p>
<p>The following is an example for the <code>nginx-hostname</code> plugin trigger. It reverses the hostname that is provided to nginx during deploys. If you created an executable file named <code>nginx-hostname</code> with the following code in your plugin trigger, it would be invoked by dokku during the normal app deployment process:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">SUBDOMAIN</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">VHOST</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nv">NEW_SUBDOMAIN</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$SUBDOMAIN</span> <span class="p">|</span> rev<span class="sb">`</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$NEW_SUBDOMAIN</span><span class="s2">.</span><span class="nv">$VHOST</span><span class="s2">&quot;</span>
</code></pre></div>
<h2 id="available-plugin-triggers">Available plugin triggers</h2>
<p>There are a number of plugin-related triggers. These can be optionally implemented by plugins and allow integration into the standard dokku setup/teardown process.</p>
<p>The following plugin triggers describe those available to a dokku installation. As well, there is an example for each trigger that you can use as templates for your own plugin development.</p>
<blockquote>
<p>The example plugin trigger code is not guaranteed to be implemented as in within dokkku, and are merely simplified examples. Please look at the dokku source for larger, more in-depth examples.</p>
</blockquote>
<h3 id="post-config-update"><code>post-config-update</code></h3>
<ul>
<li>Description: Allows you to get notified when one or more configs is added or removed. Action can be <em>set</em> or <em>unset</em></li>
<li>Invoked by: <code>dokku config:set</code>, <code>dokku config:unset</code></li>
<li>Arguments: <code>$APP</code> <code>set|unset</code> <code>key1=VALUE1 key2=VALUE2</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="bind-external-ip"><code>bind-external-ip</code></h3>
<ul>
<li>Description: Allows you to disable binding to the external box ip</li>
<li>Invoked by: <code>dokku deploy</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1"># Force always binding to the docker ip, no matter</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1"># what the settings are for a given app.</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="nb">echo</span> <span class="nb">false</span>
</code></pre></div>
<h3 id="check-deploy"><code>check-deploy</code></h3>
<ul>
<li>Description: Allows you to run checks on a deploy before dokku allows the container to handle requests.</li>
<li>Invoked by: <code>dokku deploy</code></li>
<li>Arguments: <code>$CONTAINER_ID $APP $INTERNAL_PORT $INTERNAL_IP_ADDRESS</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1"># Disables deploys of containers based on whether the</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1"># `DOKKU_DISABLE_DEPLOY` env var is set to `true` for an app</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_AVAILABLE_PATH</span><span class="s2">/config/functions&quot;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="nv">CONTAINERID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">PORT</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="nv">HOSTNAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">4</span><span class="k">:-</span><span class="nv">localhost</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="nb">eval</span> <span class="s2">&quot;</span><span class="k">$(</span>config_export app <span class="nv">$APP</span><span class="k">)</span><span class="s2">&quot;</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="nv">DOKKU_DISABLE_DEPLOY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">DOKKU_DISABLE_DEPLOY</span><span class="k">:-</span><span class="nv">false</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$DOKKU_DISABLE_DEPLOY</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>  <span class="nb">echo</span> -e <span class="s2">&quot;\033[31m\033[1mDeploys disabled, sorry.\033[0m&quot;</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>  <span class="nb">exit</span> <span class="m">1</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="k">fi</span>
</code></pre></div>
<h3 id="comands-help-and-commands-plugin_namehelp"><code>comands help</code> and <code>commands &lt;PLUGIN_NAME&gt;:help</code></h3>
<ul>
<li>Description: Your plugin should implement a <code>help</code> command in your <code>commands</code> file to take advantage of this plugin trigger. <code>commands help</code> is used by <code>dokku help</code> to aggregate all plugins abbreviated <code>help</code> output. Implementing  <code>&lt;PLUGIN_NAME&gt;:help</code> in your <code>commands</code> file gives users looking for help, a more detailed output. 'commands help' must be implemented inside the <code>commands</code> plugin file. It's recommended that <code>PLUGIN_NAME:help</code> be added to the commands file to ensure consistency among community plugins and give you a new avenue to share rich help content with your user.</li>
<li>Invoked by: <code>dokku help</code> and <code>commands &lt;PLUGIN_NAME&gt;:help</code></li>
<li>Arguments: None</li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c1"># Outputs help for the derp plugin</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="k">in</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>  <span class="nb">help</span> <span class="p">|</span> hello:help<span class="o">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    help_content_func <span class="o">()</span> <span class="o">{</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>      <span class="nb">declare</span> <span class="nv">desc</span><span class="o">=</span><span class="s2">&quot;return help_content string&quot;</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>      cat<span class="s">&lt;&lt;help_content</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="s">    hello &lt;app&gt;, Says &quot;Hello &lt;app&gt;&quot;</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="s">    hello:world, Says &quot;Hello world&quot;</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="s">help_content</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    <span class="o">}</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$1</span> <span class="o">=</span> <span class="s2">&quot;hello:help&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>        <span class="nb">echo</span> -e <span class="s1">&#39;Usage: dokku hello[:world] [&lt;app&gt;]&#39;</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>        <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>        <span class="nb">echo</span> <span class="s1">&#39;Say Hello World.&#39;</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>        <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>        <span class="nb">echo</span> <span class="s1">&#39;Example:&#39;</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>        <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>        <span class="nb">echo</span> <span class="s1">&#39;$ dokku hello:world&#39;</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>        <span class="nb">echo</span> <span class="s1">&#39;Hello world&#39;</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>        <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>        <span class="nb">echo</span> <span class="s1">&#39;Additional commands:&#39;</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>        help_content_func <span class="p">|</span> sort <span class="p">|</span> column -c2 -t -s,
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>    <span class="k">else</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>        help_content_func
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>    <span class="k">fi</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>    <span class="p">;;</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>  *<span class="o">)</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>    <span class="nb">exit</span> <span class="nv">$DOKKU_NOT_IMPLEMENTED_EXIT</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>    <span class="p">;;</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="k">esac</span>
</code></pre></div>
<h3 id="dependencies"><code>dependencies</code></h3>
<ul>
<li>Description: Used to install system-level dependencies. Invoked by <code>plugin:install-dependencies</code>.</li>
<li>Invoked by: <code>dokku plugin:install-dependencies</code></li>
<li>Arguments: None</li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1"># Installs nginx for the current plugin</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># Supports both opensuse and ubuntu</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nb">export</span> <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$DOKKU_DISTRO</span><span class="s2">&quot;</span> <span class="k">in</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>  debian<span class="p">|</span>ubuntu<span class="o">)</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    apt-get install --force-yes -qq -y nginx
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    <span class="p">;;</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>  opensuse<span class="o">)</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    zypper -q <span class="k">in</span> -y nginx
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="p">;;</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="k">esac</span>
</code></pre></div>
<h3 id="docker-args-build"><code>docker-args-build</code></h3>
<ul>
<li>Description:</li>
<li>Invoked by: <code>dokku build</code></li>
<li>Arguments: <code>$APP $IMAGE_SOURCE_TYPE</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="docker-args-deploy"><code>docker-args-deploy</code></h3>
<ul>
<li>Description:</li>
<li>Invoked by: <code>dokku deploy</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="docker-args-run"><code>docker-args-run</code></h3>
<ul>
<li>Description:</li>
<li>Invoked by: <code>dokku run</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="git-post-pull"><code>git-post-pull</code></h3>
<ul>
<li>Description:</li>
<li>Invoked by: <code>dokku git-upload-pack</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="git-pre-pull"><code>git-pre-pull</code></h3>
<ul>
<li>Description:</li>
<li>Invoked by: <code>dokku git-upload-pack</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="install"><code>install</code></h3>
<ul>
<li>Description: Used to setup any files/configuration for a plugin.</li>
<li>Invoked by: <code>dokku plugin:install</code>.</li>
<li>Arguments: None</li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c1"># Sets the hostname of the dokku server</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># based on the output of `hostname -f`</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="k">if</span> <span class="o">[[</span> ! -f  <span class="s2">&quot;</span><span class="nv">$DOKKU_ROOT</span><span class="s2">/HOSTNAME&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>  hostname -f &gt; <span class="nv">$DOKKU_ROOT</span>/HOSTNAME
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="k">fi</span>
</code></pre></div>
<h3 id="nginx-hostname"><code>nginx-hostname</code></h3>
<ul>
<li>Description: Allows you to customize the hostname for a given application.</li>
<li>Invoked by: <code>dokku domains:setup</code></li>
<li>Arguments: <code>$APP $SUBDOMAIN $VHOST</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c1"># Reverses the hostname for the application</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">SUBDOMAIN</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">VHOST</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="nv">NEW_SUBDOMAIN</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$SUBDOMAIN</span> <span class="p">|</span> rev<span class="sb">`</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$NEW_SUBDOMAIN</span><span class="s2">.</span><span class="nv">$VHOST</span><span class="s2">&quot;</span>
</code></pre></div>
<h3 id="nginx-pre-reload"><code>nginx-pre-reload</code></h3>
<ul>
<li>Description: Run before nginx reloads hosts</li>
<li>Invoked by: <code>dokku nginx:build-config</code></li>
<li>Arguments: <code>$APP $INTERNAL_PORT $INTERNAL_IP_ADDRESS</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c1"># Runs a check against all nginx conf files</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># to ensure they are valid</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>nginx -t
</code></pre></div>
<h3 id="post-build-buildpack"><code>post-build-buildpack</code></h3>
<ul>
<li>Description: Allows you to run commands after the build image is create for a given app. Only applies to applications using buildpacks.</li>
<li>Invoked by: <code>dokku build</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="post-build-dockerfile"><code>post-build-dockerfile</code></h3>
<ul>
<li>Description: Allows you to run commands after the build image is create for a given app. Only applies to applications using a dockerfile.</li>
<li>Invoked by: <code>dokku build</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="post-create"><code>post-create</code></h3>
<ul>
<li>Description: Can be used to run commands after an application is created.</li>
<li>Invoked by: <code>dokku apps:create</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="c1"># Runs a command to ensure that an app</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># has a postgres database when it is starting</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="nv">POSTGRES</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>dokku postgres:create <span class="nv">$POSTGRES</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>dokku postgres:link <span class="nv">$POSTGRES</span> <span class="nv">$APP</span>
</code></pre></div>
<h3 id="post-delete"><code>post-delete</code></h3>
<ul>
<li>Description: Can be used to run commands after an application is deleted.</li>
<li>Invoked by: <code>dokku apps:destroy</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c1"># Runs a command to ensure that an app&#39;s</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c1"># postgres installation is removed</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>dokku postgres:destroy <span class="nv">$APP</span>
</code></pre></div>
<h3 id="post-deploy"><code>post-deploy</code></h3>
<ul>
<li>Description: Allows running of commands after an application's processes have been scaled up, but before old containers are torn down. Dokku core currently uses this to switch traffic on nginx.</li>
<li>Invoked by: <code>dokku deploy</code></li>
<li>Arguments: <code>$APP $INTERNAL_PORT $INTERNAL_IP_ADDRESS $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c1"># Notify an external service that a successful deploy has occurred.</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>curl <span class="s2">&quot;http://httpstat.us/200&quot;</span>
</code></pre></div>
<h3 id="post-domains-update"><code>post-domains-update</code></h3>
<ul>
<li>Description: Allows you to run commands once the domain for an application has been updated. It also sends in the command that has been used. This can be "add", "clear" or "remove". The third argument will be the optional list of domains</li>
<li>Invoked by: <code>dokku domains:add</code>, <code>dokku domains:clear</code>, <code>dokku domains:remove</code></li>
<li>Arguments: <code>$APP</code> <code>action name</code> <code>domains</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c1"># Reloads haproxy for our imaginary haproxy plugin</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># that replaces the nginx-vhosts plugin</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>sudo service haproxy reload
</code></pre></div>
<h3 id="post-release-buildpack"><code>post-release-buildpack</code></h3>
<ul>
<li>Description: Allows you to run commands after environment variables are set for the release step of the deploy. Only applies to applications using buildpacks.</li>
<li>Invoked by: <code>dokku release</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c1"># Installs a package specified by the `CONTAINER_PACKAGE` env var</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>dokku_log_info1<span class="s2">&quot; Installing </span><span class="nv">$CONTAINER_PACKAGE</span><span class="s2">...&quot;</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="nv">CMD</span><span class="o">=</span><span class="s2">&quot;cat &gt; gm &amp;&amp; \</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="s2">  dpkg -s CONTAINER_PACKAGE &gt; /dev/null 2&gt;&amp;1 || \</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="s2">  (apt-get update &amp;&amp; apt-get install -y CONTAINER_PACKAGE &amp;&amp; apt-get clean)&quot;</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="nv">ID</span><span class="o">=</span><span class="k">$(</span>docker run <span class="nv">$DOKKU_GLOBAL_RUN_ARGS</span> -i -a stdin <span class="nv">$IMAGE</span> /bin/bash -c <span class="s2">&quot;</span><span class="nv">$CMD</span><span class="s2">&quot;</span><span class="k">)</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="nb">test</span> <span class="k">$(</span>docker <span class="nb">wait</span> <span class="nv">$ID</span><span class="k">)</span> -eq <span class="m">0</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>docker commit <span class="nv">$ID</span> <span class="nv">$IMAGE</span> &gt; /dev/null
</code></pre></div>
<h3 id="post-release-dockerfile"><code>post-release-dockerfile</code></h3>
<ul>
<li>Description: Allows you to run commands after environment variables are set for the release step of the deploy. Only applies to applications using a dockerfile.</li>
<li>Invoked by: <code>dokku release</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="post-stop"><code>post-stop</code></h3>
<ul>
<li>Description: Can be used to run commands after an application is manually stopped</li>
<li>Invoked by: <code>dokku ps:stop</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c1"># Marks an application as manually stopped</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>dokku config:set --no-restart <span class="nv">$APP</span> <span class="nv">MANUALLY_STOPPED</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<h3 id="pre-build-buildpack"><code>pre-build-buildpack</code></h3>
<ul>
<li>Description: Allows you to run commands before the build image is created for a given app. For instance, this can be useful to add env vars to your container. Only applies to applications using buildpacks.</li>
<li>Invoked by: <code>dokku build</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="pre-build-dockerfile"><code>pre-build-dockerfile</code></h3>
<ul>
<li>Description: Allows you to run commands before the build image is created for a given app. For instance, this can be useful to add env vars to your container. Only applies to applications using a dockerfile.</li>
<li>Invoked by: <code>dokku build</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="pre-delete"><code>pre-delete</code></h3>
<ul>
<li>Description: Can be used to run commands before an app is deleted.</li>
<li>Invoked by: <code>dokku apps:destroy</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c1"># Clears out the gulp asset build cache for applications</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">GULP_CACHE_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$DOKKU_ROOT</span><span class="s2">/</span><span class="nv">$APP</span><span class="s2">/gulp&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="k">if</span> <span class="o">[[</span> -d <span class="nv">$GULP_CACHE_DIR</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>  docker run <span class="nv">$DOKKU_GLOBAL_RUN_ARGS</span> --rm -v <span class="s2">&quot;</span><span class="nv">$GULP_CACHE_DIR</span><span class="s2">:/gulp&quot;</span> <span class="s2">&quot;</span><span class="nv">$IMAGE</span><span class="s2">&quot;</span> find /gulp -depth -mindepth <span class="m">1</span> -maxdepth <span class="m">1</span> -exec rm -Rf <span class="o">{}</span> <span class="se">\;</span> <span class="o">||</span> <span class="nb">true</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="k">fi</span>
</code></pre></div>
<h3 id="pre-deploy"><code>pre-deploy</code></h3>
<ul>
<li>Description: Allows the running of code before the application's processes are scaled up and after the docker images are prepared.</li>
<li>Invoked by: <code>dokku deploy</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="c1"># Runs gulp in our container</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>dokku_log_info1 <span class="s2">&quot;Running gulp&quot;</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="nv">id</span><span class="o">=</span><span class="k">$(</span>docker run <span class="nv">$DOKKU_GLOBAL_RUN_ARGS</span> -d <span class="nv">$IMAGE</span> /bin/bash -c <span class="s2">&quot;cd /app &amp;&amp; gulp default&quot;</span><span class="k">)</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="nb">test</span> <span class="k">$(</span>docker <span class="nb">wait</span> <span class="nv">$id</span><span class="k">)</span> -eq <span class="m">0</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>docker commit <span class="nv">$id</span> <span class="nv">$IMAGE</span> &gt; /dev/null
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>dokku_log_info1 <span class="s2">&quot;Building UI Complete&quot;</span>
</code></pre></div>
<h3 id="pre-receive-app"><code>pre-receive-app</code></h3>
<ul>
<li>Description: Allows you to customize the contents of an application directory before they are processed for deployment. The <code>IMAGE_SOURCE_TYPE</code> can be any of <code>[herokuish, dockerfile]</code></li>
<li>Invoked by: <code>dokku git-hook</code>, <code>dokku tar-build-locked</code></li>
<li>Arguments: <code>$APP $IMAGE_SOURCE_TYPE $TMP_WORK_DIR $REV</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c1"># Adds a file called `dokku-is-awesome` to the repository</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="c1"># the contents will be the application name</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_SOURCE_TYPE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">TMP_WORK_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">REV</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$4</span><span class="s2">&quot;</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span> &gt; <span class="s2">&quot;</span><span class="nv">$TMP_WORK_DIR</span><span class="s2">/dokku-is-awesome&quot;</span>
</code></pre></div>
<h3 id="pre-release-buildpack"><code>pre-release-buildpack</code></h3>
<ul>
<li>Description: Allows you to run commands before environment variables are set for the release step of the deploy. Only applies to applications using buildpacks.</li>
<li>Invoked by: <code>dokku release</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="c1"># Installs the graphicsmagick package into the container</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>dokku_log_info1<span class="s2">&quot; Installing GraphicsMagick...&quot;</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="nv">CMD</span><span class="o">=</span><span class="s2">&quot;cat &gt; gm &amp;&amp; \</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="s2">  dpkg -s graphicsmagick &gt; /dev/null 2&gt;&amp;1 || \</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="s2">  (apt-get update &amp;&amp; apt-get install -y graphicsmagick &amp;&amp; apt-get clean)&quot;</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="nv">ID</span><span class="o">=</span><span class="k">$(</span>docker run <span class="nv">$DOKKU_GLOBAL_RUN_ARGS</span> -i -a stdin <span class="nv">$IMAGE</span> /bin/bash -c <span class="s2">&quot;</span><span class="nv">$CMD</span><span class="s2">&quot;</span><span class="k">)</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="nb">test</span> <span class="k">$(</span>docker <span class="nb">wait</span> <span class="nv">$ID</span><span class="k">)</span> -eq <span class="m">0</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>docker commit <span class="nv">$ID</span> <span class="nv">$IMAGE</span> &gt; /dev/null
</code></pre></div>
<h3 id="pre-release-dockerfile"><code>pre-release-dockerfile</code></h3>
<ul>
<li>Description: Allows you to run commands before environment variables are set for the release step of the deploy. Only applies to applications using a dockerfile.</li>
<li>Invoked by: <code>dokku release</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$PLUGIN_CORE_AVAILABLE_PATH</span><span class="s2">/common/functions&quot;</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>verify_app_name <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2">&quot;</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="c1"># TODO</span>
</code></pre></div>
<h3 id="receive-app"><code>receive-app</code></h3>
<ul>
<li>Description: Allows you to customize what occurs when an app is received. Normally just triggers an application build.</li>
<li>Invoked by: <code>dokku git-hook</code>, <code>dokku ps:rebuild</code></li>
<li>Arguments: <code>$APP $REV</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c1"># For our imaginary mercurial plugin, triggers a rebuild</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">REV</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>dokku hg-build <span class="nv">$APP</span> <span class="nv">$REV</span>
</code></pre></div>
<h3 id="receive-branch"><code>receive-branch</code></h3>
<ul>
<li>Description: Allows you to customize what occurs when a specific branch is received. Can be used to add support for specific branch names</li>
<li>Invoked by: <code>dokku git-hook</code>, <code>dokku ps:rebuild</code></li>
<li>Arguments: <code>$APP $REV $REFNAME</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="c1"># Gives dokku the ability to support multiple branches for a given service</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="c1"># Allowing you to have multiple staging environments on a per-branch basis</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="nv">reference_app</span><span class="o">=</span><span class="nv">$1</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="nv">refname</span><span class="o">=</span><span class="nv">$3</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="nv">newrev</span><span class="o">=</span><span class="nv">$2</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="nv">APP</span><span class="o">=</span><span class="si">${</span><span class="nv">refname</span><span class="p">/*</span><span class="se">\/</span><span class="p">/</span><span class="si">}</span>.<span class="nv">$reference_app</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="k">if</span> <span class="o">[[</span> ! -d <span class="s2">&quot;</span><span class="nv">$DOKKU_ROOT</span><span class="s2">/</span><span class="nv">$APP</span><span class="s2">&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>  <span class="nv">REFERENCE_REPO</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$DOKKU_ROOT</span><span class="s2">/</span><span class="nv">$reference_app</span><span class="s2"></span>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="s2">  git clone --bare --shared --reference &quot;</span><span class="nv">$REFERENCE_REPO</span><span class="s2">&quot; &quot;</span><span class="nv">$REFERENCE_REPO</span><span class="s2">&quot; &quot;</span><span class="nv">$DOKKU_ROOT</span>/<span class="nv">$APP</span><span class="s2">&quot; &gt; /dev/null</span>
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="s2">fi</span>
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="s2">plugn trigger receive-app </span><span class="nv">$APP</span><span class="s2"> </span><span class="nv">$newrev</span><span class="s2"></span>
</code></pre></div>
<h3 id="retire-container-failed"><code>retire-container-failed</code></h3>
<ul>
<li>Description: Allows you to run commands if/when retiring old containers has failed</li>
<li>Invoked by: <code>dokku deploy</code></li>
<li>Arguments: <code>$APP</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="c1"># Send an email when a container failed to retire</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">HOSTNAME</span><span class="o">=</span><span class="k">$(</span>hostname -s<span class="k">)</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>mail -s <span class="s2">&quot;</span><span class="nv">$APP</span><span class="s2"> containers on </span><span class="nv">$HOSTNAME</span><span class="s2"> failed to retire&quot;</span> ops@example.com
</code></pre></div>
<h3 id="tags-create"><code>tags-create</code></h3>
<ul>
<li>Description: Allows you to run commands once a tag for an application image has been added</li>
<li>Invoked by: <code>dokku tags:create</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c1"># Upload an application image to docker hub</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE</span><span class="o">=</span><span class="k">$(</span>get_app_image_name <span class="nv">$APP</span> <span class="nv">$IMAGE_TAG</span><span class="k">)</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="nv">IMAGE_ID</span><span class="o">=</span><span class="k">$(</span>docker inspect --format <span class="s1">&#39;{{ .Id }}&#39;</span> <span class="nv">$IMAGE</span><span class="k">)</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>docker tag -f <span class="nv">$IMAGE_ID</span> <span class="nv">$DOCKER_HUB_USER</span>/<span class="nv">$APP</span>:<span class="nv">$IMAGE_TAG</span>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>docker push <span class="nv">$DOCKER_HUB_USER</span>/<span class="nv">$APP</span>:<span class="nv">$IMAGE_TAG</span>
</code></pre></div>
<h3 id="tags-destroy"><code>tags-destroy</code></h3>
<ul>
<li>Description: Allows you to run commands once a tag for an application image has been removed</li>
<li>Invoked by: <code>dokku tags:destroy</code></li>
<li>Arguments: <code>$APP $IMAGE_TAG</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="c1"># Remove an image tag from docker hub</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="nv">APP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>some code to remove a docker hub tag because it<span class="err">&#39;</span>s not implemented <span class="k">in</span> the CLI....
</code></pre></div>
<h3 id="update"><code>update</code></h3>
<ul>
<li>Description: Can be used to run plugin updates on a regular interval. You can schedule the invoker in a cron-task to ensure your system gets regular updates.</li>
<li>Invoked by: <code>dokku plugin:update</code>.</li>
<li>Arguments: None</li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="c1"># Update the herokuish image from git source</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="nb">cd</span> /root/dokku
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>sudo <span class="nv">BUILD_STACK</span><span class="o">=</span><span class="nb">true</span> make install
</code></pre></div>
<h3 id="user-auth"><code>user-auth</code></h3>
<p>This is a special plugin trigger that is executed on <em>every</em> command run. As dokku sometimes internally invokes the <code>dokku</code> command, special care should be taken to properly handle internal command redirects.</p>
<p>Note that the trigger should exit as follows:</p>
<ul>
<li><code>0</code> to continue running as normal</li>
<li><code>1</code> to halt execution of the command</li>
</ul>
<p>The <code>SSH_USER</code> is the original ssh user. If you are running remote commands, this user will typically be <code>dokku</code>, and as such should not be trusted when checking permissions. If you are connected via ssh as a different user who then invokes <code>dokku</code>, the value of this variable will be that user's name (<code>root</code>, <code>myuser</code>, etc.).</p>
<p>The <code>SSH_NAME</code> is the <code>NAME</code> variable set via the <code>sshcommand acl-add</code> command. If you have set a user via the <code>dokku-installer</code>, this value will be set to <code>admin</code>. For installs via debian package, this value <em>may</em> be <code>default</code>. For reference, the following command can be run as the root user to specify a specific <code>NAME</code> for a given ssh key:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>sshcommand acl-add dokku NAME &lt; <span class="nv">$PATH_TO_SSH_KEY</span>
</code></pre></div>
<p>Note that the <code>NAME</code> value is set at the first ssh key match. If an ssh key is set in the <code>/home/dokku/.ssh/authorized_keys</code> multiple times, the first match will decide the value.</p>
<ul>
<li>Description: Allows you to deny access to a dokku command by either ssh user or associated ssh-command NAME user.</li>
<li>Invoked by <code>dokku</code></li>
<li>Arguments: <code>$SSH_USER $SSH_NAME $DOKKU_COMMAND</code></li>
<li>Example:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="c1"># Allow root/admin users to do everything</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="c1"># Deny plugin access to default users</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="c1"># Allow access to all other commands</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="nb">set</span> -eo pipefail<span class="p">;</span> <span class="o">[[</span> <span class="nv">$DOKKU_TRACE</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">set</span> -x
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="nv">SSH_USER</span><span class="o">=</span><span class="nv">$1</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="nv">SSH_NAME</span><span class="o">=</span><span class="nv">$2</span>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="nb">shift</span> <span class="m">2</span>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$SSH_USER</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$SSH_NAME</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;admin&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span>
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$SSH_NAME</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$1</span> <span class="o">==</span> plugin:* <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="nb">exit</span> <span class="m">0</span>
</code></pre></div>




              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../plugin-creation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Plugin Creation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Plugin Creation
            </div>
          </div>
        </a>
      
      
        
        <a href="../testing/" class="md-footer__link md-footer__link--next" aria-label="Next: Dokku test suite" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Dokku test suite
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/dokku/dokku/issues" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M352 96v3.56c0 15.74-12.7 28.44-28.4 28.44H188.4c-15.7 0-29.3-12.7-29.3-28.44V96c0-53.02 43-96 96-96C309 0 352 42.98 352 96zm-310.63 9.4c12.5-12.52 32.76-12.52 45.26 0l63.97 64c.7.6 1.3 1.3 1.9 2 14.3-7.3 30.4-11.4 46.6-11.4H312c17.1 0 33.2 4.1 47.5 11.4.6-.7 1.2-1.4 1.9-2l64-64c12.5-12.52 32.7-12.52 45.2 0 12.5 12.5 12.5 32.7 0 45.2l-64 64c-1.5.7-1.3 1.3-2 1.9 6.1 12 10 25.4 11.1 39.5H480c17.7 0 32 14.3 32 32s-14.3 32-32 32h-64c0 24.6-5.5 47.8-15.4 68.6 2.1 1.3 4.2 2.9 6 4.8l64 64c12.5 12.5 12.5 32.7 0 45.2s-32.7 12.5-45.2 0l-63.1-63c-24.5 21.8-55.8 36.2-90.3 39.6V240c0-8.8-7.2-16-16.9-16-7.9 0-16 7.2-16 16v239.2c-33.6-3.4-64.9-17.8-89.4-39.6l-63.07 63c-12.5 12.5-32.76 12.5-45.26 0-12.49-12.5-12.49-32.7 0-45.2l64.03-64c1.8-1.9 3.9-3.5 6-4.8-9.9-20.8-15.4-44-15.4-68.6H32c-17.67 0-32-14.3-32-32s14.33-32 32-32h64.3c1.08-14.1 5-27.5 11.1-39.5-.7-.6-1.4-1.2-2-1.9l-64.03-64c-12.49-12.5-12.49-32.7 0-45.2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://dokku.dpdcart.com/cart/add?product_id=217344&method_id=236878" target="_blank" rel="noopener" title="dokku.dpdcart.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M96 0c11.5 0 21.4 8.19 23.6 19.51L121.1 32h420.7c20.3 0 36.5 20.25 30.8 40.66l-54 192.04c-3.9 13.8-16.5 23.3-30.8 23.3H170.7l9.2 48H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H159.1c-10.6 0-20.5-8.2-22.7-19.5L76.14 48H24C10.75 48 0 37.25 0 24S10.75 0 24 0h72zm32 464c0-26.5 21.5-48 48-48s48 21.5 48 48-21.5 48-48 48-48-21.5-48-48zm384 0c0 26.5-21.5 48-48 48s-48-21.5-48-48 21.5-48 48-48 48 21.5 48 48z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "search.highlight"], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    

  <!-- Extra JavaScript (can't be set in mkdocs.yml due to content hash) -->
  <script src="../../overrides/assets/javascripts/bundle.js"></script>

  </body>
</html>